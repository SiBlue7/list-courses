<h3>Résultats ({{ ingredients|length }})</h3>
{% if ingredients %}
    {% for ingredient in ingredients %}
        <div class="list-item">
            <div>
                <strong>{{ ingredient.name }}</strong>
                <div class="small muted">
                    {% if ingredient.category %}
                        {{ ingredient.category.name }}
                    {% else %}
                        Sans catégorie
                    {% endif %}
                </div>
            </div>
            <form method="post" style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                {% csrf_token %}
                <input type="hidden" name="ingredient_id" value="{{ ingredient.id }}" />
                <input type="hidden" name="q" value="{{ ingredient_query }}" />
                <input type="hidden" name="category" value="{{ selected_category }}" />

                <label class="small" for="qty_recipe_{{ ingredient.id }}">Qté / pers.</label>
                <input id="qty_recipe_{{ ingredient.id }}" type="number" step="0.01" min="0.01" name="quantity_per_person" required />

                <label class="small" for="unit_recipe_{{ ingredient.id }}">Unité</label>
                <select id="unit_recipe_{{ ingredient.id }}" name="unit">
                    {% for unit_value, unit_label in unit_choices %}
                        <option value="{{ unit_value }}">{{ unit_label }}</option>
                    {% endfor %}
                </select>

                <button class="btn primary" type="submit">Ajouter</button>
            </form>
        </div>
    {% endfor %}
{% else %}
    <p class="muted">Aucun ingrédient trouvé pour ce filtre.</p>
{% endif %}
